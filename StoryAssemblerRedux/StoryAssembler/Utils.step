RunStory ?frag:
    [StoryAssembler ?]
    # [Paragraph]
    # [StoryAssembler ?]
    # [Paragraph]
    # [StoryAssembler ?]
    # [Paragraph]
    # [StoryAssembler ?]
    # [Paragraph]
    # [StoryAssembler ?]
    # [Paragraph]
[end]

initially:
    [set ^CurrentScene = test]
    [set ^CatTemp = empty]
[end]

RunStoryWrap: [RunStory ?frag]

# Custom list operations
Cat ?l1 ?l2 ?result:
    [set ^CatTemp = empty]
    [add 1 CatTemp]
    # [DoAll [Member ?x ?l1] [add 1 CatTemp]]
    # [DoAll [Member ?x ?l2] [add 1 ^CatTemp]]
    [= ?result ^CatTemp]
[end]

Add ?element ?list:
    [set ^ETemp = ?element]
    [set ^LTemp = ?list]
    [add ^ETemp ^LTemp]
    [= ?new_list ^LTemp]
[end]

# Custom max check
[predicate]
MaxOf ?x ?y ?max: [< ?x ?y] [set ?max = ?y]
MaxOf ?x ?y ?max: [set ?max = ?x]

SetupTestScene:
    [set CurrentScene = test]
    [InitScene ^CurrentScene]
[end]
